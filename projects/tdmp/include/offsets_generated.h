#ifndef TDMP_GENERATED_OFFSETS_H
#define TDMP_GENERATED_OFFSETS_H

// Generated by dumper.cc
// Date: Jun 26 2024
// Time: 03:58:06

#include "memory/memory.h"

#define SET_AND_CHECK_OFFSET(addr, addr_name) \
    do { \
        addr = base + addr; \
        console::writeln("  {} = 0x{:X}", addr_name, addr); \
        if (!mem::isAddressExecutable(addr)) { \
            failedOffsets.push_back(addr_name); \
        } \
    } while (0)

namespace tdmp::offsets {

    namespace lua {
        inline uint64_t lua_newstate = 0x39b360;
    }

    namespace game {
        inline uint64_t log = 0x408b10;
    }

    inline bool generate(std::vector<std::string>& failedOffsets) {
        const uint64_t base = mem::baseAddress();

        console::writeln("Offsets:");

        SET_AND_CHECK_OFFSET(lua::lua_newstate, "lua::lua_newstate");
        SET_AND_CHECK_OFFSET(game::log, "game::log");

        return failedOffsets.size() == 0;
    }

}

#endif // TDMP_GENERATED_OFFSETS_H